<div class="main-container" [formGroup]="assistanceForm">
    <div class="cmb-container">
        <app-custom-autocomplete
        [customLabel]="'Seleccione un departamento'"
        [placeholder]="'Seleccione un departamento'"
        [customFormControlName]="'departamento'"
        [items]="departamentos"
        (onSelectedValue)="onDepartamentoChange($event)"
        ></app-custom-autocomplete>
        <app-custom-autocomplete
        [customLabel]="'Seleccione un cargo'"
        [placeholder]="'Seleccione un cargo'"
        [customFormControlName]="'cargo'"
        [items]="cargos"
        (onSelectedValue)="onCargoChange($event)"
        ></app-custom-autocomplete>
    </div>

    <button
    mat-button
    color="accent"
    (click)="openCreate()"
    >Crear nuevo usuario</button>
</div>

<div class="table-container">
    <mat-card class="card" >
        <div class="table-card-container">
            <table class="table" mat-table [dataSource]="table.dataSource" >
                <ng-container matColumnDef="usuario">
                    <th mat-header-cell *matHeaderCellDef> Usuario </th>
                    <td mat-cell *matCellDef="let user">
                        <span > {{user.usuario}}</span>
                    </td>
                </ng-container>
                <ng-container matColumnDef="nombre">
                    <th mat-header-cell *matHeaderCellDef> Nombres </th>
                    <td mat-cell *matCellDef="let user">
                        {{user.primerNombre + ' ' + user.segundoNombre }}
                    </td>
                </ng-container>
                <ng-container matColumnDef="apellido">
                    <th mat-header-cell *matHeaderCellDef> Apellidos </th>
                    <td mat-cell *matCellDef="let user">
                        {{user.primerApellido + ' ' + user.segundoApellido }}
                    </td>
                </ng-container>
                <ng-container matColumnDef="departamento">
                    <th mat-header-cell *matHeaderCellDef> Departamento </th>
                    <td mat-cell *matCellDef="let user" >
                        {{user!.departamento.nombre}}
                    </td>
                </ng-container>
                <ng-container matColumnDef="cargo">
                    <th mat-header-cell *matHeaderCellDef> Cargo </th>
                    <td mat-cell *matCellDef="let user">
                        {{user!.cargo.nombre }}
                    </td>
                </ng-container>
                <ng-container matColumnDef="email">
                    <th mat-header-cell *matHeaderCellDef> Email </th>
                    <td mat-cell *matCellDef="let user">
                        {{user!.email }}
                    </td>
                </ng-container>
                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef> Acciones </th>
                    <td mat-cell *matCellDef="let user">
                        <button mat-button (click)="openEdit(user)" color="primary" >
                            <mat-icon>edit</mat-icon>
                            <span>Editar</span>
                        </button>
                        <button mat-button color="warn" 
                            (click)="openDelete(user)" >
                            <mat-icon>clear</mat-icon>
                            <span>Eliminar</span>
                        </button>
                    </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="table.headers; sticky: true"></tr>
                <tr mat-row *matRowDef="let row; columns: table.headers;"></tr>
            </table>
            <div class="footer">
                <span>Total Registros: {{usuarios.length}}</span>
            </div>
        </div>
    </mat-card>
</div>
